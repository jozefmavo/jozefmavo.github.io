import{w as me,S as O,i as q,s as z,e as d,a as b,b as $,t as A,c as C,d as i,l as F,n as M,f as w,o as ce,g as ze,h as fe,j as v,k as G,m as I,p as he,q as ge,r as K,u as J,v as T,x as H,y as Q,z as ke,A as Se,B as ht,C as Te,D as ct,E,F as Ue,G as We,H as Be,I as ut,J as ft,K as Pe}from"./vendor.4fa4e416.js";const gt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))t(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerpolicy&&(o.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?o.credentials="include":l.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}};gt();const ee=new URLSearchParams(location.search),pt="1201",_t="users?archived=false&fields=archived%2Ccode%2Cprefix%2ClastName%2CfirstName&isStudent=true&schoolInSchoolYear=",bt="users?archived=false&fields=archived%2Ccode%2Cprefix%2ClastName%2CisEmployee&isEmployee=true&schoolInSchoolYear=",dt=new Map([["teacherSchedule","id%2CappointmentInstance%2CbranchOfSchool%2Cgroups%2CstartTimeSlot%2CstartTimeSlotName%2Cstart%2CendTimeSlot%2CendTimeSlotName%2Cend%2Csubjects%2Cteachers%2ConlineTeachers%2Clocations%2Ctype%2Cvalid%2Ccancelled%2CteacherChanged%2CgroupChanged%2ClocationChanged%2CtimeChanged%2CchangeDescription%2Ccontent%2Cremark%2CschedulerRemark%2ClocationsOfBranch%2CgroupsInDepartments%2CchoosableInDepartmentCodes%2Coptional%2Coptional"],["studentSchedule","start%2Cend%2CstartTimeSlotName%2Ctype%2Cteachers%2Csubjects%2Cgroups%2Clocations%2Cremark%2CschedulerRemark%2CchangeDescription%2Ccancelled%2CteacherChanged%2CtimeChanged%2ClocationChanged%2CchoosableInDepartmentCodes"],["classSchedule","id%2CappointmentInstance%2CbranchOfSchool%2Cgroups%2CstartTimeSlot%2CstartTimeSlotName%2Cstart%2CendTimeSlot%2CendTimeSlotName%2Cend%2Csubjects%2Cteachers%2ConlineTeachers%2Clocations%2Ctype%2Cvalid%2Ccancelled%2CteacherChanged%2CgroupChanged%2ClocationChanged%2CtimeChanged%2CchangeDescription%2Ccontent%2Cremark%2CschedulerRemark%2ClocationsOfBranch%2CgroupsInDepartments%2CchoosableInDepartmentCodes%2Coptional"],["getStudentClassAppointments","groupsInDepartments%2Csubjects"]]),Ne=me(),$t=me(!0),je=me();let De=me(!1);const mt=me(),He=me();function vt(s){let e,n,t,l,o,a,r,c,u,p,_,m,f;return{c(){e=d("div"),n=d("div"),t=d("h1"),t.textContent="Login",l=b(),o=d("p"),o.textContent="Please provide login information to continue to Zermelo.",a=b(),r=d("input"),c=b(),u=d("input"),p=b(),_=d("button"),_.textContent="Login",$(t,"class","svelte-1w0gyqm"),$(o,"class","svelte-1w0gyqm"),$(r,"placeholder","schoolname"),$(r,"class","svelte-1w0gyqm"),A(r,"error",s[2]),$(u,"placeholder","pairing code"),$(u,"type","number"),$(u,"class","svelte-1w0gyqm"),A(u,"error",s[2]),$(_,"class","svelte-1w0gyqm"),$(n,"class","centered svelte-1w0gyqm"),$(e,"class","svelte-1w0gyqm")},m(g,h){C(g,e,h),i(e,n),i(n,t),i(n,l),i(n,o),i(n,a),i(n,r),s[4](r),i(n,c),i(n,u),s[5](u),i(n,p),i(n,_),m||(f=F(_,"click",s[3]),m=!0)},p(g,[h]){h&4&&A(r,"error",g[2]),h&4&&A(u,"error",g[2])},i:M,o:M,d(g){g&&w(e),s[4](null),s[5](null),m=!1,f()}}}function Ct(s,e,n){let t,l,o;ce(async()=>{console.log("login loaded!"),await Ie()&&te("HomePage")});async function a(){if(!t.value||!l.value){r();return}console.debug("Logging in:"),await Ie(t.value,l.value),fe(B)?window.location.reload():r()}function r(){n(2,o=!0),setTimeout(()=>{n(2,o=!1)},3e3)}function c(p){ze[p?"unshift":"push"](()=>{t=p,n(0,t)})}function u(p){ze[p?"unshift":"push"](()=>{l=p,n(1,l)})}return[t,l,o,a,c,u]}class wt extends O{constructor(e){super();q(this,e,Ct,vt,z,{})}}function kt(s){let e,n,t,l,o,a,r,c;return{c(){e=d("div"),n=d("h3"),n.textContent="Jozefmavo Zermelo Portal",t=b(),l=d("p"),l.textContent="Click the button to go to the schedule.",o=b(),a=d("button"),a.textContent="Schedule",$(e,"class","homepage")},m(u,p){C(u,e,p),i(e,n),i(e,t),i(e,l),i(e,o),i(e,a),r||(c=F(a,"click",s[0]),r=!0)},p:M,i:M,o:M,d(u){u&&w(e),r=!1,c()}}}function St(s){function e(){te("SchedulePeople")}return[e]}class yt extends O{constructor(e){super();q(this,e,St,kt,z,{})}}function Mt(s){let e,n,t,l,o,a,r,c;return{c(){e=d("div"),n=d("h1"),n.textContent="404",t=b(),l=d("p"),l.textContent="That page could not be found.",o=b(),a=d("button"),a.textContent="Home",$(a,"class","svelte-10ckbbi"),$(e,"class","content svelte-10ckbbi")},m(u,p){C(u,e,p),i(e,n),i(e,t),i(e,l),i(e,o),i(e,a),r||(c=F(a,"click",s[0]),r=!0)},p:M,i:M,o:M,d(u){u&&w(e),r=!1,c()}}}function Tt(s){function e(){te("HomePage")}return[e]}class Nt extends O{constructor(e){super();q(this,e,Tt,Mt,z,{})}}function Dt(s){let e,n,t,l,o,a,r,c,u=(s[0].classes||"")+"",p,_,m;return{c(){e=d("div"),n=d("p"),t=v(s[6]),l=b(),o=d("p"),a=v(s[7]),r=b(),c=d("p"),p=v(u),$(c,"class","classes"),$(e,"class","appointment"),G(e,"left",s[3]+"px"),G(e,"width",s[4]+"px"),G(e,"top",s[5]+"px"),A(e,"cancelled",s[0].cancelled),A(e,"changed",s[1]),A(e,"newTime",s[2])},m(f,g){C(f,e,g),i(e,n),i(n,t),i(e,l),i(e,o),i(o,a),i(e,r),i(e,c),i(c,p),_||(m=F(e,"click",s[8]),_=!0)},p(f,[g]){g&64&&I(t,f[6]),g&128&&I(a,f[7]),g&1&&u!==(u=(f[0].classes||"")+"")&&I(p,u),g&8&&G(e,"left",f[3]+"px"),g&16&&G(e,"width",f[4]+"px"),g&32&&G(e,"top",f[5]+"px"),g&1&&A(e,"cancelled",f[0].cancelled),g&2&&A(e,"changed",f[1]),g&4&&A(e,"newTime",f[2])},i:M,o:M,d(f){f&&w(e),_=!1,m()}}}function Lt(s,e,n){let{appointment:t}=e;function l(){mt.set(t),De.set(!0)}let o,a=!1,r,c,u,p,_;return ce(()=>{n(1,o=t.teacherChanged||t.locationChanged),n(2,a=t.timeChanged),n(3,r=(t.startMin-440)*2),n(4,c=(t.endMin-t.startMin)*2-2),n(5,u=42+t.rowNr*80-80),n(6,p=`${t.subjects[0]||t.teachers.join(" ").toUpperCase()} - ${t.locations.length?t.locations:"0_00"}`),n(7,_=t.subjects[0]?t.teachers.join(" ").toUpperCase():"")}),s.$$set=m=>{"appointment"in m&&n(0,t=m.appointment)},[t,o,a,r,c,u,p,_,l]}class It extends O{constructor(e){super();q(this,e,Lt,Dt,z,{appointment:0})}}function Fe(s,e,n){const t=s.slice();return t[1]=e[n],t}function Re(s){let e,n=s[1].d+"",t,l;return{c(){e=d("div"),t=v(n),l=b(),$(e,"class","appointment leftrow"),G(e,"left","0px"),G(e,"width","80px"),G(e,"top",2+80*s[1].i-40+"px"),A(e,"today",new Date().getDay()==s[1].i)},m(o,a){C(o,e,a),i(e,t),i(e,l)},p(o,a){a&1&&A(e,"today",new Date().getDay()==o[1].i)},d(o){o&&w(e)}}}function Pt(s){let e,n=s[0],t=[];for(let l=0;l<n.length;l+=1)t[l]=Re(Fe(s,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=he()},m(l,o){for(let a=0;a<t.length;a+=1)t[a].m(l,o);C(l,e,o)},p(l,[o]){if(o&1){n=l[0];let a;for(a=0;a<n.length;a+=1){const r=Fe(l,n,a);t[a]?t[a].p(r,o):(t[a]=Re(r),t[a].c(),t[a].m(e.parentNode,e))}for(;a<t.length;a+=1)t[a].d(1);t.length=n.length}},i:M,o:M,d(l){ge(t,l),l&&w(e)}}}function Ht(s){return[[{i:1,d:"Mon"},{i:2,d:"Tue"},{i:3,d:"Wed"},{i:4,d:"Thu"},{i:5,d:"Fri"}]]}class Yt extends O{constructor(e){super();q(this,e,Ht,Pt,z,{})}}function Ze(s,e,n){const t=s.slice();return t[1]=e[n],t}function Ge(s){let e,n=s[1].start.h.toString().padStart(2,"0")+"",t,l,o=s[1].start.m.toString().padStart(2,"0")+"",a,r,c=s[1].end.h.toString().padStart(2,"0")+"",u,p,_=s[1].end.m.toString().padStart(2,"0")+"",m,f;return{c(){e=d("div"),t=v(n),l=v(":"),a=v(o),r=v(" - "),u=v(c),p=v(":"),m=v(_),f=b(),$(e,"class","appointment timenote"),G(e,"left",(s[1].startMin-440)*2+"px"),G(e,"width",(s[1].endMin-s[1].startMin)*2-2+"px"),G(e,"height","40px"),G(e,"top","0px")},m(g,h){C(g,e,h),i(e,t),i(e,l),i(e,a),i(e,r),i(e,u),i(e,p),i(e,m),i(e,f)},p:M,d(g){g&&w(e)}}}function At(s){let e,n=s[0],t=[];for(let l=0;l<n.length;l+=1)t[l]=Ge(Ze(s,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=he()},m(l,o){for(let a=0;a<t.length;a+=1)t[a].m(l,o);C(l,e,o)},p(l,[o]){if(o&1){n=l[0];let a;for(a=0;a<n.length;a+=1){const r=Ze(l,n,a);t[a]?t[a].p(r,o):(t[a]=Ge(r),t[a].c(),t[a].m(e.parentNode,e))}for(;a<t.length;a+=1)t[a].d(1);t.length=n.length}},i:M,o:M,d(l){ge(t,l),l&&w(e)}}}function jt(s){return[[{startMin:480,endMin:540,start:{h:8,m:0},end:{h:9,m:0}},{startMin:540,endMin:600,start:{h:9,m:0},end:{h:10,m:0}},{startMin:600,endMin:660,start:{h:10,m:0},end:{h:11,m:0}},{startMin:660,endMin:720,start:{h:11,m:0},end:{h:12,m:0}},{startMin:720,endMin:780,start:{h:12,m:0},end:{h:13,m:0}},{startMin:780,endMin:840,start:{h:13,m:0},end:{h:14,m:0}},{startMin:840,endMin:900,start:{h:14,m:0},end:{h:15,m:0}},{startMin:900,endMin:960,start:{h:15,m:0},end:{h:16,m:0}},{startMin:960,endMin:1020,start:{h:16,m:0},end:{h:17,m:0}},{startMin:1020,endMin:1080,start:{h:17,m:0},end:{h:18,m:0}}]]}class Ut extends O{constructor(e){super();q(this,e,jt,At,z,{})}}function Ye(s,e){je.set({type:s,id:e}),te("SchedulePeople")}function Ke(s){let e,n,t;return n=new ht({props:{value:s[1],items:s[0]}}),n.$on("select",s[2]),{c(){e=d("div"),K(n.$$.fragment),$(e,"class","select-holder")},m(l,o){C(l,e,o),J(n,e,null),t=!0},p(l,o){const a={};o&1&&(a.items=l[0]),n.$set(a)},i(l){t||(T(n.$$.fragment,l),t=!0)},o(l){H(n.$$.fragment,l),t=!1},d(l){l&&w(e),Q(n)}}}function Wt(s){let e,n,t=s[0]&&Ke(s);return{c(){t&&t.c(),e=he()},m(l,o){t&&t.m(l,o),C(l,e,o),n=!0},p(l,[o]){l[0]?t?(t.p(l,o),o&1&&T(t,1)):(t=Ke(l),t.c(),T(t,1),t.m(e.parentNode,e)):t&&(ke(),H(t,1,1,()=>{t=null}),Se())},i(l){n||(T(t),n=!0)},o(l){H(t),n=!1},d(l){t&&t.d(l),l&&w(e)}}}function Bt(s,e,n){let t,l=[];ce(a);function o(r){const c=r.detail.value,u=c.code;status="Schedule for "+r.label,console.log(r,c,u),Ye(c.isEmployee?"teacher":"student",u)}async function a(){const r=Array.prototype.concat((await Oe()).response.data,(await Ee()).response.data);console.table(r),n(0,l=[]);for(let c=0;c<r.length;c++){const[u,p,_,m]=[r[c].firstName||"",r[c].prefix||"",r[c].lastName||"",r[c].code||""];l.push({label:`${u} ${p} ${_}`+(r[c].isEmployee?` (${m.toUpperCase()})`:""),value:r[c]})}}return He.subscribe(a),[l,t,o]}class Et extends O{constructor(e){super();q(this,e,Bt,Wt,z,{})}}function Ot(s){let e=[];for(let n=0;n<s.length;n++){const t=s[n],l=new Date(t.start*1e3).getDay()-new Date(ye(de.prev)).getDay()+2;e.push({rowNr:l,startMin:new Date(t.start*1e3).getHours()*60+new Date(t.start*1e3).getMinutes(),endMin:new Date(t.end*1e3).getHours()*60+new Date(t.end*1e3).getMinutes(),slotName:t.startTimeSlotName,locations:t.locations,teachers:t.teachers,subjects:t.subjects,cancelled:t.cancelled,changeWarning:t.changeDescription,teacherChanged:t.teacherChanged,locationChanged:t.locationChanged,timeChanged:t.timeChanged,start:{h:new Date(t.start*1e3).getHours(),m:new Date(t.start*1e3).getMinutes()},end:{h:new Date(t.end*1e3).getHours(),m:new Date(t.end*1e3).getMinutes()},classes:t.groups,startTimeStamp:t.start,endTimeStamp:t.end})}return e}function Je(s,e,n){const t=s.slice();return t[11]=e[n],t}function qt(s){let e;return{c(){e=v("Loading...")},m(n,t){C(n,e,t)},p:M,d(n){n&&w(e)}}}function zt(s){let e;function n(o,a){return o[1].id?Rt:Ft}let t=n(s),l=t(s);return{c(){l.c(),e=he()},m(o,a){l.m(o,a),C(o,e,a)},p(o,a){t===(t=n(o))&&l?l.p(o,a):(l.d(1),l=t(o),l&&(l.c(),l.m(e.parentNode,e)))},d(o){l.d(o),o&&w(e)}}}function Ft(s){let e;return{c(){e=v("No schedule selected.")},m(n,t){C(n,e,t)},p:M,d(n){n&&w(e)}}}function Rt(s){let e=(s[4]||"Loading...")+"",n;return{c(){n=v(e)},m(t,l){C(t,n,l)},p(t,l){l&16&&e!==(e=(t[4]||"Loading...")+"")&&I(n,e)},d(t){t&&w(n)}}}function Qe(s){let e,n;return e=new It({props:{appointment:s[11]}}),{c(){K(e.$$.fragment)},m(t,l){J(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.appointment=t[11]),e.$set(o)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){H(e.$$.fragment,t),n=!1},d(t){Q(e,t)}}}function Zt(s){let e,n,t,l,o,a,r=parseInt(Te().format("W"))+s[3]+"",c,u,p,_,m,f,g,h,y,U,P,j,R,ne,se,V,x,_e,le,oe,ae,be,ue;y=new Et({});function $e(S,Y){return S[2]?qt:zt}let re=$e(s),W=re(s);x=new Yt({}),le=new Ut({});let X=s[0],N=[];for(let S=0;S<X.length;S+=1)N[S]=Qe(Je(s,X,S));const ve=S=>H(N[S],1,1,()=>{N[S]=null});return{c(){e=d("div"),n=d("h3"),t=d("button"),t.textContent="arrow_back_ios_new",l=b(),o=d("span"),a=v("Week "),c=v(r),u=b(),p=d("button"),p.textContent="arrow_forward_ios",_=b(),m=d("button"),m.textContent="date_range",f=b(),g=d("div"),h=b(),K(y.$$.fragment),U=b(),P=d("div"),j=b(),R=d("h3"),W.c(),ne=b(),se=d("div"),V=d("div"),K(x.$$.fragment),_e=b(),K(le.$$.fragment),oe=b();for(let S=0;S<N.length;S+=1)N[S].c();$(t,"class","material-icons"),$(o,"class","week"),$(p,"class","material-icons"),$(m,"class","material-icons"),$(g,"class","sep"),$(P,"class","sep"),$(e,"class","header"),$(V,"class","grid"),$(se,"class","content")},m(S,Y){C(S,e,Y),i(e,n),i(n,t),i(n,l),i(n,o),i(o,a),i(o,c),i(n,u),i(n,p),i(n,_),i(n,m),i(n,f),i(n,g),i(n,h),J(y,n,null),i(n,U),i(n,P),i(e,j),i(e,R),W.m(R,null),C(S,ne,Y),C(S,se,Y),i(se,V),J(x,V,null),i(V,_e),J(le,V,null),i(V,oe);for(let D=0;D<N.length;D+=1)N[D].m(V,null);ae=!0,be||(ue=[F(t,"click",s[5]),F(p,"click",s[6]),F(m,"click",s[7])],be=!0)},p(S,[Y]){if((!ae||Y&8)&&r!==(r=parseInt(Te().format("W"))+S[3]+"")&&I(c,r),re===(re=$e(S))&&W?W.p(S,Y):(W.d(1),W=re(S),W&&(W.c(),W.m(R,null))),Y&1){X=S[0];let D;for(D=0;D<X.length;D+=1){const Ce=Je(S,X,D);N[D]?(N[D].p(Ce,Y),T(N[D],1)):(N[D]=Qe(Ce),N[D].c(),T(N[D],1),N[D].m(V,null))}for(ke(),D=X.length;D<N.length;D+=1)ve(D);Se()}},i(S){if(!ae){T(y.$$.fragment,S),T(x.$$.fragment,S),T(le.$$.fragment,S);for(let Y=0;Y<X.length;Y+=1)T(N[Y]);ae=!0}},o(S){H(y.$$.fragment,S),H(x.$$.fragment,S),H(le.$$.fragment,S),N=N.filter(Boolean);for(let Y=0;Y<N.length;Y+=1)H(N[Y]);ae=!1},d(S){S&&w(e),Q(y),W.d(),S&&w(ne),S&&w(se),Q(x),Q(le),ge(N,S),be=!1,ct(ue)}}}function Gt(s,e,n){E.extend(Ue),E.extend(We),E.extend(Be);let t=[],l=[],o={id:""},a=!1,r=0,c;je.subscribe(async f=>{if(f){n(2,a=!0),n(1,o=f),u(f.type,f.id);const g=f.type=="teacher",h=await un(f.id),y=await cn(f.id);let U=y.firstName||"",P=y.prefix||h.prefix||"",j=y.lastName||h.lastName,R=(y.code||h.code).toUpperCase();n(4,c=(g?"":`${U} `)+`${P} ${j} (${R})`),n(2,a=!1)}}),ce(()=>{const f=new URLSearchParams(location.search),g=f.get("person_id"),h=f.get("person_type");n(2,a=!1),console.error(g,h,f.getAll("person")),g&&h&&(je.set({type:h,id:g}),u(h,g,!0))});async function u(f,g,h=!0){let y;n(0,l=[]),f=="student"?y=await rn(g,r+1):y=await an(g,r+1),h&&ut(`./?m=${ee.get("m")}&person_id=${g}&person_type=${f}`),ee.set("person_id",g),ee.set("person_type",f),console.log(y.response),t=qe(y.response.data,"start"),n(0,l=Ot(t)),n(2,a=!1)}function p(){r+parseInt(Te().format("W"))>1&&(n(3,r-=1),u(o.type,o.id))}function _(){r+parseInt(Te().format("W"))<52&&(n(3,r+=1),u(o.type,o.id))}function m(){r!=0&&(n(3,r=0),u(o.type,o.id))}return setInterval(()=>{60*parseInt(E().format("HH"))+parseInt(E().format("m"))},300),[l,o,a,r,c,p,_,m,u]}class Kt extends O{constructor(e){super();q(this,e,Gt,Zt,z,{openSched:8})}get openSched(){return this.$$.ctx[8]}}function Jt(s){let e,n,t,l,o;return n=new Kt({}),{c(){e=d("div"),K(n.$$.fragment),$(e,"class","svelte-za3vn1")},m(a,r){C(a,e,r),J(n,e,null),t=!0,l||(o=F(e,"mousedown",s[0]),l=!0)},p:M,i(a){t||(T(n.$$.fragment,a),t=!0)},o(a){H(n.$$.fragment,a),t=!1},d(a){a&&w(e),Q(n),l=!1,o()}}}function Qt(s){function e(n){const t=n.composedPath();let l=!0;for(let o=0;o<t.length;o++){const a=t[o];if(a.classList&&a.classList.contains("sidebar")){l=!1;break}}l&&$t.set(!1)}return[e]}class Vt extends O{constructor(e){super();q(this,e,Qt,Jt,z,{})}}function Ve(s,e,n){const t=s.slice();return t[4]=e[n],t}function Xe(s){let e,n=s[4].firstName+"",t,l,o=(s[4].prefix||"")+"",a,r,c=s[4].lastName+"",u,p,_,m=s[4].code.toUpperCase()+"",f,g,h,y;return{c(){e=d("button"),t=v(n),l=b(),a=v(o),r=b(),u=v(c),p=b(),_=d("span"),f=v(m),g=b(),$(_,"class","right")},m(U,P){C(U,e,P),i(e,t),i(e,l),i(e,a),i(e,r),i(e,u),i(e,p),i(e,_),i(_,f),i(e,g),h||(y=F(e,"click",function(){ft(s[1](s[4].code))&&s[1](s[4].code).apply(this,arguments)}),h=!0)},p(U,P){s=U,P&1&&n!==(n=s[4].firstName+"")&&I(t,n),P&1&&o!==(o=(s[4].prefix||"")+"")&&I(a,o),P&1&&c!==(c=s[4].lastName+"")&&I(u,c),P&1&&m!==(m=s[4].code.toUpperCase()+"")&&I(f,m)},d(U){U&&w(e),h=!1,y()}}}function Xt(s){let e,n,t,l,o,a,r=s[0].length+"",c,u,p,_=s[0],m=[];for(let f=0;f<_.length;f+=1)m[f]=Xe(Ve(s,_,f));return{c(){e=d("div"),n=d("h3"),t=d("span"),t.textContent="Students",l=b(),o=d("span"),a=v("("),c=v(r),u=v(")"),p=b();for(let f=0;f<m.length;f+=1)m[f].c();$(e,"class","studentlist")},m(f,g){C(f,e,g),i(e,n),i(n,t),i(n,l),i(n,o),i(o,a),i(o,c),i(o,u),i(e,p);for(let h=0;h<m.length;h+=1)m[h].m(e,null)},p(f,[g]){if(g&1&&r!==(r=f[0].length+"")&&I(c,r),g&3){_=f[0];let h;for(h=0;h<_.length;h+=1){const y=Ve(f,_,h);m[h]?m[h].p(y,g):(m[h]=Xe(y),m[h].c(),m[h].m(e,null))}for(;h<m.length;h+=1)m[h].d(1);m.length=_.length}},i:M,o:M,d(f){f&&w(e),ge(m,f)}}}function xt(s,e,n){let t;Pe(s,B,r=>n(2,t=r));let l=[];B.subscribe(r=>{r&&a()});function o(r){return function(){Ye("student",r)}}ce(async()=>{t&&a()});async function a(){n(0,l=(await Ee()).response.data),l.length>0&&n(0,l=qe(l,"firstName"))}return[l,o]}class en extends O{constructor(e){super();q(this,e,xt,Xt,z,{})}}function xe(s,e,n){const t=s.slice();return t[4]=e[n],t}function et(s){let e,n=(s[4].prefix||"")+"",t,l,o=s[4].lastName+"",a,r,c,u=s[4].code.toUpperCase()+"",p,_,m,f;return{c(){e=d("button"),t=v(n),l=b(),a=v(o),r=b(),c=d("span"),p=v(u),_=b(),$(c,"class","right")},m(g,h){C(g,e,h),i(e,t),i(e,l),i(e,a),i(e,r),i(e,c),i(c,p),i(e,_),m||(f=F(e,"click",function(){ft(s[1](s[4].code))&&s[1](s[4].code).apply(this,arguments)}),m=!0)},p(g,h){s=g,h&1&&n!==(n=(s[4].prefix||"")+"")&&I(t,n),h&1&&o!==(o=s[4].lastName+"")&&I(a,o),h&1&&u!==(u=s[4].code.toUpperCase()+"")&&I(p,u)},d(g){g&&w(e),m=!1,f()}}}function tn(s){let e,n,t,l,o,a,r=s[0].length+"",c,u,p,_=s[0],m=[];for(let f=0;f<_.length;f+=1)m[f]=et(xe(s,_,f));return{c(){e=d("div"),n=d("h3"),t=d("span"),t.textContent="Teachers",l=b(),o=d("span"),a=v("("),c=v(r),u=v(")"),p=b();for(let f=0;f<m.length;f+=1)m[f].c();$(e,"class","studentlist")},m(f,g){C(f,e,g),i(e,n),i(n,t),i(n,l),i(n,o),i(o,a),i(o,c),i(o,u),i(e,p);for(let h=0;h<m.length;h+=1)m[h].m(e,null)},p(f,[g]){if(g&1&&r!==(r=f[0].length+"")&&I(c,r),g&3){_=f[0];let h;for(h=0;h<_.length;h+=1){const y=xe(f,_,h);m[h]?m[h].p(y,g):(m[h]=et(y),m[h].c(),m[h].m(e,null))}for(;h<m.length;h+=1)m[h].d(1);m.length=_.length}},i:M,o:M,d(f){f&&w(e),ge(m,f)}}}function nn(s,e,n){let t;Pe(s,B,r=>n(2,t=r));let l=[];B.subscribe(r=>{r&&a()});function o(r){return function(){Ye("teacher",r)}}ce(()=>{t&&a()});async function a(){n(0,l=(await Oe()).response.data),l.length>0&&n(0,l=qe(l,"lastName"))}return[l,o]}class ln extends O{constructor(e){super();q(this,e,nn,tn,z,{})}}function te(s){const e=Le.has(s);He.set(Le.get(e?s:"PageNotFound")),ee.set("m",e?s:"PageNotFound");const n=ee.get("person_id")?`&person_id=${ee.get("person_id")}`:"",t=ee.get("person_type")?`&person_type=${ee.get("person_type")}`:"";ee.set("person_id",""),ee.set("class_id",""),ut(`./?m=${e?s:"PageNotFound"}${s=="SchedulePeople"?`${n}${t}`:""}`),De.set(!1)}const Le=new Map([["HomePage",{name:"Home",icon:"home",content:yt,sidebar:!1}],["SchedulePeople",{name:"People",icon:"people",content:Vt,sidebar:!0}],["ListStudents",{name:"Students",icon:"school",content:en,sidebar:!0}],["ListTeachers",{name:"Teachers",icon:"supervisor_account",content:ln,sidebar:!0}],["Login",{name:"Login",icon:"",content:wt,sidebar:!1}],["PageNotFound",{name:"Page Not Found",icon:"",content:Nt,sidebar:!1}]]);E.extend(Ue);E.extend(We);E.extend(Be);async function Me(s,e,n,t=!0,l,o){if(fe(B)||l){const a={headers:{Authorization:`Bearer ${s}`},method:o?"POST":"GET"},r=await await fetch(`https://${e}.zportal.nl/api/v3/${n}`,l?{method:o?"POST":"GET"}:a);return t?r.json():r.text()}return t?{}:"{}"}async function sn(s,e){return await Me(void 0,e,`oauth/token?grant_type=authorization_code&code=${s}`,!0,!0,!0)}let B=me(!1),pe,ie;async function Ie(s,e){if(localStorage.getItem("accessToken")){pe=localStorage.getItem("accessToken"),ie=localStorage.getItem("school");const n=await(await fetch(`https://${ie}.zportal.nl/api/v3/users/~me`,{headers:{Authorization:`Bearer ${pe}`}})).json();return B.set(n.response.status==200),B?(console.debug("Zermelo login succeeded from stored access token"),Ne.set(n.response.data)):console.log("Zermelo login failed from stored access token: server returned ",n.response),fe(B)}if(!s||!e)return console.log("Zermelo login failed; school or bindcode invalid"),!1;try{const n=await sn(e,s);n.access_token&&(localStorage.setItem("accessToken",n.access_token),localStorage.setItem("school",s),B.set(!0),Ne.set((await(await fetch(`https://${ie}.zportal.nl/api/v3/users/~me`,{headers:{Authorization:`Bearer ${pe}`}})).json()).response.data)),fe(B)&&console.log("Zermelo login succeeded from provided data",fe(B))}catch{B.set(!1)}return fe(B)}function on(){localStorage.removeItem("school"),localStorage.removeItem("accessToken"),B.set(!1),te("Login")}async function Ee(){return await Me(pe,ie,`${_t}${pt}`)}async function Oe(){return await Me(pe,ie,`${bt}${pt}`)}async function an(s,e=0){const n=ye(de.prev)+601200*e,t=ye(de.next)+601200*e;return await Me(pe,ie,`appointments?start=${n}&end=${t}&teachers=${s}&fields=${dt.get("teacherSchedule")}`,!0)}async function rn(s,e=0){const n=ye(de.prev)+601200*e,t=ye(de.next)+601200*e;return await Me(pe,ie,`appointments?user=${s}&start=${n}&end=${t}&fields=${dt.get("studentSchedule")}`,!0)}function ye(s){let e;return s==de.prev?e=E().weekday(-7).unix():e=E().weekday(0).unix(),e}async function cn(s){const e=(await Ee()).response.data;for(let n=0;n<e.length;n++)if(e[n].code==s)return e[n];return{}}async function un(s){const e=(await Oe()).response.data;for(let n=0;n<e.length;n++)if(e[n].code==s)return e[n];return{}}function qe(s,e){return s.sort(function(n,t){var l=n[e],o=t[e];return l<o?-1:l>o?1:0})}var de=(s=>(s[s.prev=0]="prev",s[s.next=1]="next",s))(de||{});function tt(s,e,n){const t=s.slice();return t[1]=e[n],t}function nt(s){let e,n=s[1].icon+"",t,l,o,a,r;return{c(){e=d("button"),t=v(n),l=b(),$(e,"class","material-icons"),$(e,"title",o=s[1].caption)},m(c,u){C(c,e,u),i(e,t),i(e,l),a||(r=F(e,"click",s[1].action),a=!0)},p(c,u){s=c},d(c){c&&w(e),a=!1,r()}}}function fn(s){let e,n=s[0],t=[];for(let l=0;l<n.length;l+=1)t[l]=nt(tt(s,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=he()},m(l,o){for(let a=0;a<t.length;a+=1)t[a].m(l,o);C(l,e,o)},p(l,[o]){if(o&1){n=l[0];let a;for(a=0;a<n.length;a+=1){const r=tt(l,n,a);t[a]?t[a].p(r,o):(t[a]=nt(r),t[a].c(),t[a].m(e.parentNode,e))}for(;a<t.length;a+=1)t[a].d(1);t.length=n.length}},i:M,o:M,d(l){ge(t,l),l&&w(e)}}}function pn(s){return[[{icon:"logout",action:()=>{on()},caption:"Logout"},{icon:"calendar_today",action:()=>{Ye("student",fe(Ne)[0].code)},caption:"Show own calendar"}]]}class dn extends O{constructor(e){super();q(this,e,pn,fn,z,{})}}function mn(s){let e,n,t,l,o,a,r,c,u,p,_,m,f,g,h,y=s[0].firstName+"",U,P;return c=new dn({}),{c(){e=d("div"),n=d("div"),t=d("b"),t.innerHTML=`Zermelo
      <div class="sep"></div>`,l=b(),o=d("span"),o.textContent=`${ie}`,a=b(),r=d("div"),K(c.$$.fragment),u=b(),p=d("div"),_=b(),m=d("div"),f=d("span"),f.textContent="person",g=b(),h=d("p"),U=v(y),$(t,"class","name"),$(o,"class","schoolname"),$(n,"class","header"),$(p,"class","sep"),$(f,"class","material-icons"),$(m,"class","userprofile"),$(r,"class","right"),$(e,"class","tb")},m(j,R){C(j,e,R),i(e,n),i(n,t),i(n,l),i(n,o),i(e,a),i(e,r),J(c,r,null),i(r,u),i(r,p),i(r,_),i(r,m),i(m,f),i(m,g),i(m,h),i(h,U),P=!0},p(j,[R]){(!P||R&1)&&y!==(y=j[0].firstName+"")&&I(U,y)},i(j){P||(T(c.$$.fragment,j),P=!0)},o(j){H(c.$$.fragment,j),P=!1},d(j){j&&w(e),Q(c)}}}function hn(s,e,n){let t;return Ne.subscribe(l=>{n(0,t=l[0])}),[t]}class gn extends O{constructor(e){super();q(this,e,hn,mn,z,{})}}function lt(s,e,n){const t=s.slice();return t[3]=e[n][0],t[4]=e[n][1],t}function _n(s){let e,n,t=s[4].icon+"",l,o,a,r=s[4].name+"",c,u,p,_;function m(){return s[2](s[3])}return{c(){e=d("button"),n=d("span"),l=v(t),o=b(),a=d("p"),c=v(r),u=b(),$(n,"class","material-icons svelte-1syb81y"),$(a,"class","svelte-1syb81y"),$(e,"class","svelte-1syb81y"),A(e,"selected",s[0]&&s[0].name==s[4].name)},m(f,g){C(f,e,g),i(e,n),i(n,l),i(e,o),i(e,a),i(a,c),i(e,u),p||(_=F(e,"click",m),p=!0)},p(f,g){s=f,g&1&&A(e,"selected",s[0]&&s[0].name==s[4].name)},d(f){f&&w(e),p=!1,_()}}}function st(s){let e,n=s[4].sidebar&&s[4]&&_n(s);return{c(){n&&n.c(),e=he()},m(t,l){n&&n.m(t,l),C(t,e,l)},p(t,l){t[4].sidebar&&t[4]&&n.p(t,l)},d(t){n&&n.d(t),t&&w(e)}}}function bn(s){let e,n,t,l,o,a=[...Le],r=[];for(let c=0;c<a.length;c+=1)r[c]=st(lt(s,a,c));return{c(){e=d("div"),n=d("button"),n.innerHTML=`<span class="material-icons svelte-1syb81y">home</span> 
    <p class="svelte-1syb81y">Home</p>`,t=b();for(let c=0;c<r.length;c+=1)r[c].c();$(n,"class","home svelte-1syb81y"),A(n,"selected",s[0].name=="Home"),$(e,"class","sidebar svelte-1syb81y")},m(c,u){C(c,e,u),i(e,n),i(e,t);for(let p=0;p<r.length;p+=1)r[p].m(e,null);l||(o=F(n,"click",s[1]),l=!0)},p(c,[u]){if(u&1&&A(n,"selected",c[0].name=="Home"),u&1){a=[...Le];let p;for(p=0;p<a.length;p+=1){const _=lt(c,a,p);r[p]?r[p].p(_,u):(r[p]=st(_),r[p].c(),r[p].m(e,null))}for(;p<r.length;p+=1)r[p].d(1);r.length=a.length}},i:M,o:M,d(c){c&&w(e),ge(r,c),l=!1,o()}}}function $n(s,e,n){let t;Pe(s,He,a=>n(0,t=a));function l(){te("HomePage")}return[t,l,a=>te(a)]}class vn extends O{constructor(e){super();q(this,e,$n,bn,z,{})}}function ot(s){let e,n,t=(s[0].subjects.toString().toUpperCase()||"appointment")+"",l,o,a,r,c,u=(s[0].locations.length?s[0].locations:"None")+"",p,_,m,f,g,h=s[0].teachers.length>1?"s":"",y,U,P=s[0].teachers.join(" ").toUpperCase()+"",j,R,ne,se,V,x=E(s[0].startTimeStamp*1e3).format("DD/MM/YYYY, hh:mm A")+"",_e,le,oe,ae,be,ue=E(s[0].endTimeStamp*1e3).format("DD/MM/YYYY, hh:mm A")+"",$e,re,W,X,N,ve=s[0].classes.length>1?"s":"",S,Y,D=(s[0].classes.length?s[0].classes:"Unknown")+"",Ce,Ae,we,Z=s[0].changeWarning&&at(s);return{c(){e=d("h3"),n=v("Information for "),l=v(t),o=b(),a=d("p"),r=d("b"),r.textContent="Location",c=v(": "),p=v(u),_=b(),m=d("p"),f=d("b"),g=v("Teacher"),y=v(h),U=v(": "),j=v(P),R=b(),ne=d("p"),se=d("b"),se.textContent="Start",V=v(": "),_e=v(x),le=b(),oe=d("p"),ae=d("b"),ae.textContent="End",be=v(": "),$e=v(ue),re=b(),W=d("p"),X=d("b"),N=v("Group"),S=v(ve),Y=v(": "),Ce=v(D),Ae=b(),Z&&Z.c(),we=he()},m(k,L){C(k,e,L),i(e,n),i(e,l),C(k,o,L),C(k,a,L),i(a,r),i(a,c),i(a,p),C(k,_,L),C(k,m,L),i(m,f),i(f,g),i(f,y),i(m,U),i(m,j),C(k,R,L),C(k,ne,L),i(ne,se),i(ne,V),i(ne,_e),C(k,le,L),C(k,oe,L),i(oe,ae),i(oe,be),i(oe,$e),C(k,re,L),C(k,W,L),i(W,X),i(X,N),i(X,S),i(W,Y),i(W,Ce),C(k,Ae,L),Z&&Z.m(k,L),C(k,we,L)},p(k,L){L&1&&t!==(t=(k[0].subjects.toString().toUpperCase()||"appointment")+"")&&I(l,t),L&1&&u!==(u=(k[0].locations.length?k[0].locations:"None")+"")&&I(p,u),L&1&&h!==(h=k[0].teachers.length>1?"s":"")&&I(y,h),L&1&&P!==(P=k[0].teachers.join(" ").toUpperCase()+"")&&I(j,P),L&1&&x!==(x=E(k[0].startTimeStamp*1e3).format("DD/MM/YYYY, hh:mm A")+"")&&I(_e,x),L&1&&ue!==(ue=E(k[0].endTimeStamp*1e3).format("DD/MM/YYYY, hh:mm A")+"")&&I($e,ue),L&1&&ve!==(ve=k[0].classes.length>1?"s":"")&&I(S,ve),L&1&&D!==(D=(k[0].classes.length?k[0].classes:"Unknown")+"")&&I(Ce,D),k[0].changeWarning?Z?Z.p(k,L):(Z=at(k),Z.c(),Z.m(we.parentNode,we)):Z&&(Z.d(1),Z=null)},d(k){k&&w(e),k&&w(o),k&&w(a),k&&w(_),k&&w(m),k&&w(R),k&&w(ne),k&&w(le),k&&w(oe),k&&w(re),k&&w(W),k&&w(Ae),Z&&Z.d(k),k&&w(we)}}}function at(s){let e,n,t,l,o,a,r=s[0].changeWarning+"",c;return{c(){e=d("hr"),n=b(),t=d("p"),l=d("b"),l.textContent="Warning",o=v(":"),a=d("br"),c=v(r)},m(u,p){C(u,e,p),C(u,n,p),C(u,t,p),i(t,l),i(t,o),i(t,a),i(t,c)},p(u,p){p&1&&r!==(r=u[0].changeWarning+"")&&I(c,r)},d(u){u&&w(e),u&&w(n),u&&w(t)}}}function Cn(s){let e,n,t,l,o,a,r,c=s[0]&&ot(s);return{c(){e=d("div"),n=b(),t=d("div"),l=d("button"),l.textContent="close",o=b(),c&&c.c(),$(e,"class","shade"),A(e,"hidden",!s[1]),$(l,"class","material-icons"),$(t,"class","dialog"),A(t,"hidden",!s[1])},m(u,p){C(u,e,p),C(u,n,p),C(u,t,p),i(t,l),i(t,o),c&&c.m(t,null),a||(r=[F(e,"click",s[2]),F(l,"click",s[2])],a=!0)},p(u,[p]){p&2&&A(e,"hidden",!u[1]),u[0]?c?c.p(u,p):(c=ot(u),c.c(),c.m(t,null)):c&&(c.d(1),c=null),p&2&&A(t,"hidden",!u[1])},i:M,o:M,d(u){u&&w(e),u&&w(n),u&&w(t),c&&c.d(),a=!1,ct(r)}}}function wn(s,e,n){E.extend(Ue),E.extend(We),E.extend(Be);let t,l;mt.subscribe(a=>n(0,t=a)),De.subscribe(a=>n(1,l=a));function o(){De.set(!1)}return[t,l,o]}class kn extends O{constructor(e){super();q(this,e,wn,Cn,z,{})}}function rt(s){let e,n,t,l;return e=new vn({}),t=new gn({}),{c(){K(e.$$.fragment),n=b(),K(t.$$.fragment)},m(o,a){J(e,o,a),C(o,n,a),J(t,o,a),l=!0},i(o){l||(T(e.$$.fragment,o),T(t.$$.fragment,o),l=!0)},o(o){H(e.$$.fragment,o),H(t.$$.fragment,o),l=!1},d(o){Q(e,o),o&&w(n),Q(t,o)}}}function it(s){let e,n,t,l,o;var a=s[1].content;function r(c){return{}}return a&&(n=new a(r())),l=new kn({}),{c(){e=d("div"),n&&K(n.$$.fragment),t=b(),K(l.$$.fragment),$(e,"class","content-field svelte-rh6lpl")},m(c,u){C(c,e,u),n&&J(n,e,null),i(e,t),J(l,e,null),o=!0},p(c,u){if(a!==(a=c[1].content)){if(n){ke();const p=n;H(p.$$.fragment,1,0,()=>{Q(p,1)}),Se()}a?(n=new a(r()),K(n.$$.fragment),T(n.$$.fragment,1),J(n,e,t)):n=null}},i(c){o||(n&&T(n.$$.fragment,c),T(l.$$.fragment,c),o=!0)},o(c){n&&H(n.$$.fragment,c),H(l.$$.fragment,c),o=!1},d(c){c&&w(e),n&&Q(n),Q(l)}}}function Sn(s){let e,n,t,l,o=s[0]&&rt(),a=s[1]&&it(s);return{c(){e=d("div"),n=d("div"),o&&o.c(),t=b(),a&&a.c(),$(n,"class","content svelte-rh6lpl"),$(e,"class","bg svelte-rh6lpl")},m(r,c){C(r,e,c),i(e,n),o&&o.m(n,null),i(n,t),a&&a.m(n,null),l=!0},p(r,[c]){r[0]?o?c&1&&T(o,1):(o=rt(),o.c(),T(o,1),o.m(n,t)):o&&(ke(),H(o,1,1,()=>{o=null}),Se()),r[1]?a?(a.p(r,c),c&2&&T(a,1)):(a=it(r),a.c(),T(a,1),a.m(n,null)):a&&(ke(),H(a,1,1,()=>{a=null}),Se())},i(r){l||(T(o),T(a),l=!0)},o(r){H(o),H(a),l=!1},d(r){r&&w(e),o&&o.d(),a&&a.d()}}}function yn(s,e,n){let t=!1,l;return ce(async()=>{n(0,t=await Ie()),t?(B.set(!0),te("HomePage")):te("Login")}),He.subscribe(o=>n(1,l=o)),[t,l]}class Mn extends O{constructor(e){super();q(this,e,yn,Sn,z,{})}}function Tn(s){let e,n,t;return n=new Mn({}),{c(){e=d("div"),K(n.$$.fragment),$(e,"class","app")},m(l,o){C(l,e,o),J(n,e,null),t=!0},p:M,i(l){t||(T(n.$$.fragment,l),t=!0)},o(l){H(n.$$.fragment,l),t=!1},d(l){l&&w(e),Q(n)}}}function Nn(s,e,n){let t;return Pe(s,B,l=>n(0,t=l)),ce(async()=>{if(await Ie(),!t){te("Login");return}const l=ee.get("m"),o=l=="Login";te(l&&!o?l:"HomePage")}),[]}class Dn extends O{constructor(e){super();q(this,e,Nn,Tn,z,{})}}new Dn({target:document.getElementById("app")});
